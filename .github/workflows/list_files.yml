name: SSH to Server and List Files

on:
    workflow_dispatch: # Trigger manually

jobs:
    ssh-and-list-files:
        runs-on: ubuntu-latest
      
        steps:
        - name: Checkout code
          uses: actions/checkout@v3

        - name: Debug - Check secrets exist
          run: |
              echo "SSH_HOST exists: ${{ secrets.trading_server.SSH_HOST != '' }}"
              echo "SSH_USERNAME exists: ${{ secrets.trading_server.SSH_USERNAME != '' }}"
              echo "SSH_PRIVATE_KEY exists: ${{ secrets.trading_server.SSH_PRIVATE_KEY != '' }}"
              echo "SSH_PORT exists: ${{ secrets.trading_server.SSH_PORT != '' }}"

        - name: SSH into server and list files
          uses: appleboy/ssh-action@v0.1.5
          with:
              host: ${{ secrets.trading_server.SSH_HOST }}
              username: ${{ secrets.trading_server.SSH_USERNAME }}
              key: ${{ secrets.trading_server.SSH_PRIVATE_KEY }}
              port: ${{ secrets.trading_server.SSH_PORT }}
              script: |
                  cd mm-quant-trading-engine
                  ls -la
                  pwd
